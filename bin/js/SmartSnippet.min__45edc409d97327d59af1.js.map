{"version":3,"sources":["SmartSnippet.min__45edc409d97327d59af1.js","./src/utils/AccessibleModal.ts","./src/ui/SmartSnippet/SmartSnippet.ts","./src/ui/FocusTrap/FocusTrap.ts","./src/misc/AttachShadowPolyfill.ts","./src/ui/SmartSnippet/UserFeedbackBanner.ts","./src/ui/SmartSnippet/HeightLimiter.ts","./src/ui/SmartSnippet/ExplanationModal.ts","./src/ui/FormWidgets/RadioButton.ts"],"names":["webpackJsonpCoveo__temporary","220","module","exports","__webpack_require__","__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","defineProperty","value","className","ownerElement","modalboxModule","options","ModalBox","sizeMod","get","focusTrap","enumerable","configurable","activeModal","modalBox","content","wrapper","element","querySelector","openResult","parameters","isOpen","openModalAndTrap","validation","origin","title","DomUtils","getQuickviewHeader","result","bindings","el","makeAccessible","open","initiallyFocusedElement","document","activeElement","onModalClose","body","overlayClose","FocusTrap","close","setAttribute","headerElement","makeCloseButtonAccessible","closeButton","l","tabIndex","focus","$$","on","KeyboardUtils","keypressAction","KEYBOARD","ENTER","click","disable","contains","AccessibleModal","295","__extends","extendStatics","setPrototypeOf","__proto__","Array","d","b","__","constructor","create","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","done","then","apply","__generator","verb","v","op","f","TypeError","_","y","label","ops","pop","trys","push","g","sent","throw","return","Symbol","iterator","reasons","analytics","AnalyticsSmartSnippetFeedbackReason","DoesNotAnswer","localeKey","PartiallyAnswers","WasNotAQuestion","Other","hasDetails","BASE_CLASSNAME","SOURCE_CLASSNAME","SmartSnippetClassNames","QUESTION_CLASSNAME","ANSWER_CONTAINER_CLASSNAME","HAS_ANSWER_CLASSNAME","SHADOW_CLASSNAME","CONTENT_CLASSNAME","SOURCE_TITLE_CLASSNAME","SOURCE_URL_CLASSNAME","SmartSnippet","ID","bind","onRootElement","QueryEvents","deferredQuerySuccess","data","handleQuerySuccess","_this","children","filter","HTMLScriptElement","type","toLowerCase","map","innerHTML","join","set","hasAnswer","toggleClass","createDom","appendChild","buildAnswerContainer","feedbackBanner","UserFeedbackBanner","isUseful","sendLikeSmartSnippetAnalytics","sendDislikeSmartSnippetAnalytics","openExplanationModal","build","explanationModal","ExplanationModal","reason","id","replace","onSelect","sendExplanationAnalytics","details","onClosed","sendCloseFeedbackModalAnalytics","searchInterface","modalContainer","modalBoxModule","buildQuestion","buildShadow","buildHeightLimiter","buildSourceContainer","questionContainer","shadowContainer","snippetContainer","shadowLoading","attachShadow","mode","shadow","style","buildStyle","heightLimiter","HeightLimiter","isExpanded","sendExpandSmartSnippetAnalytics","sendCollapseSmartSnippetAnalytics","toggleButton","sourceContainer","styleTag","createElement","getCorrespondingResult","questionAnswer","find","queryController","getLastResults","results","raw","documentId","contentIdKey","contentIdValue","_a","render","lastRenderedResult","ensureDom","innerText","question","renderSnippet","answerSnippet","renderSource","Utils","resolveAfter","onContentHeightChanged","source","empty","renderSourceUrl","clickUri","renderSourceTitle","renderLink","url","text","href","enableAnalyticsOnLink","sendOpenSourceAnalytics","link","sendAnalytics","addEventListener","preventDefault","openLink","ctrlKey","newTab","window","location","sendOpenFeedbackModalAnalytics","explainWhy","usageAnalytics","logCustomEvent","analyticsActionCauseList","likeSmartSnippet","dislikeSmartSnippet","expandSmartSnippet","collapseSmartSnippet","openSmartSnippetSource","openSmartSnippetFeedbackModal","closeSmartSnippetFeedbackModal","sendSmartSnippetReason","doExport","exportGlobally","Component","Initialization","registerAutoCreateComponent","465","container","hiddenElements","enable","sortBy","querySelectorAll","removeEventListener","focusInEvent","focusOutEvent","showHiddenElements","enabled","onFocusIn","onFocusOut","hideAllExcept","removeAttribute","hideElement","getAttribute","hideSiblings","allowedElement","parent","parentElement","without","forEach","elementToHide","getFocusableSibling","previous","elements","focusableElements","currentIndex","indexOf","focusSibling","sibling","focusFirstElement","elementIsBefore","oldElement","newElement","compareDocumentPosition","Node","DOCUMENT_POSITION_PRECEDING","onLosingFocus","Defer","defer","focusIsAllowed","elementIsInPage","relatedTarget","target","517","init","iframe","onLoad","iframeBody","shadowRoot","scrolling","contentDocument","margin","autoUpdateHeight","elementToResize","MutationObserver","height","clientHeight","observe","attributes","characterData","childList","subtree","555","582","697","698","UsefulState","ROOT_CLASSNAME","LABEL_CLASSNAME","ICON_CLASSNAME","THANK_YOU_BANNER_CLASSNAME","UserFeedbackBannerClassNames","CONTAINER_CLASSNAME","BUTTONS_CONTAINER_CLASSNAME","YES_BUTTON_CLASSNAME","NO_BUTTON_CLASSNAME","BUTTON_ACTIVE_CLASSNAME","THANK_YOU_BANNER_ACTIVE_CLASSNAME","EXPLAIN_WHY_CLASSNAME","EXPLAIN_WHY_ACTIVE_CLASSNAME","sendUsefulnessAnalytics","onExplainWhyPressed","Unknown","labelId","uniqueId","ariaLive","buildContainer","buildThankYouBanner","ariaLabelledby","buildLabel","buildButtons","thankYouBanner","buildButton","action","requestExplaination","buttonsContainer","yesButton","showThankYouBanner","icon","SVGIcons","icons","checkYes","ariaPressed","ariaDescribedby","noButton","clearSmall","button","Yes","No","addClass","699","BUTTON_CLASSNAME","HeightLimiterClassNames","CONTAINER_ACTIVE_CLASSNAME","CONTAINER_EXPANDED_CLASSNAME","BUTTON_LABEL_CLASSNAME","BUTTON_ICON_CLASSNAME","containerElement","contentElement","heightLimit","onToggle","updateActiveAppearance","ariaLabel","ariaHidden","buttonLabel","buttonIcon","toggle","updateButton","shouldBeActive","contentHeight","updateExpandedAppearance","arrowUp","arrowDown","700","EXPLANATION_SECTION_CLASSNAME","REASONS_CLASSNAME","REASONS_LABEL_CLASSNAME","DETAILS_SECTION_CLASSNAME","DETAILS_TEXTAREA_CLASSNAME","DETAILS_LABEL_CLASSNAME","BUTTONS_SECTION_CLASSNAME","SEND_BUTTON_CLASSNAME","CANCEL_BUTTON_CLASSNAME","DETAILS_ID","ExplanationModalClassNames","shouldCallCloseEvent","modal","selectedReason","detailsTextArea","buildContent","buildExplanationSection","buildButtonsSection","detailsSection","buildDetailsSection","buildReasons","buildSendButton","buildCancelButton","reasonsContainer","buildReasonsLabel","buildReasonRadioButton","select","radioButton","getElement","for","disabled","RadioButton","isSelected","701","94","onChange","name","reset","currentlySelected","getRadio","checked","triggerChange","getValue","getLabel","radioOption","radioInput","labelInput","append"],"mappings":"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","file":"SmartSnippet.min__45edc409d97327d59af1.js","sourcesContent":["webpackJsonpCoveo__temporary([19,53],{\n\n/***/ 220:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ExternalModulesShim_1 = __webpack_require__(26);\nvar FocusTrap_1 = __webpack_require__(465);\nvar Strings_1 = __webpack_require__(6);\nvar Dom_1 = __webpack_require__(1);\nvar KeyboardUtils_1 = __webpack_require__(25);\nvar Core_1 = __webpack_require__(20);\nvar AccessibleModal = /** @class */ (function () {\n    function AccessibleModal(className, ownerElement, modalboxModule, options) {\n        if (modalboxModule === void 0) { modalboxModule = ExternalModulesShim_1.ModalBox; }\n        if (options === void 0) { options = {}; }\n        this.className = className;\n        this.ownerElement = ownerElement;\n        this.modalboxModule = modalboxModule;\n        this.options = __assign({\n            sizeMod: 'big'\n        }, options);\n    }\n    Object.defineProperty(AccessibleModal.prototype, \"isOpen\", {\n        get: function () {\n            return !!this.focusTrap;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AccessibleModal.prototype, \"element\", {\n        get: function () {\n            return this.activeModal && this.activeModal.modalBox;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AccessibleModal.prototype, \"content\", {\n        get: function () {\n            return this.activeModal && this.activeModal.content;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AccessibleModal.prototype, \"wrapper\", {\n        get: function () {\n            return this.activeModal && this.activeModal.wrapper;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AccessibleModal.prototype, \"headerElement\", {\n        get: function () {\n            return this.element && this.element.querySelector('.coveo-modal-header h1');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AccessibleModal.prototype.openResult = function (parameters) {\n        if (this.isOpen) {\n            return;\n        }\n        this.openModalAndTrap({\n            content: parameters.content,\n            validation: parameters.validation,\n            origin: parameters.origin,\n            title: Core_1.DomUtils.getQuickviewHeader(parameters.result, parameters.options, parameters.bindings).el\n        });\n        this.makeAccessible(parameters.options.title || parameters.result.title);\n    };\n    AccessibleModal.prototype.open = function (parameters) {\n        if (this.isOpen) {\n            return;\n        }\n        this.openModalAndTrap(parameters);\n        this.makeAccessible();\n    };\n    AccessibleModal.prototype.openModalAndTrap = function (parameters) {\n        var _this = this;\n        this.initiallyFocusedElement = parameters.origin || document.activeElement;\n        this.activeModal = this.modalboxModule.open(parameters.content, {\n            title: parameters.title,\n            className: this.className,\n            validation: function () {\n                _this.onModalClose();\n                return parameters.validation();\n            },\n            body: this.ownerElement,\n            sizeMod: this.options.sizeMod,\n            overlayClose: this.options.overlayClose\n        });\n        this.focusTrap = new FocusTrap_1.FocusTrap(this.element);\n    };\n    AccessibleModal.prototype.close = function () {\n        if (!this.isOpen) {\n            return;\n        }\n        this.activeModal.close();\n        this.activeModal = null;\n    };\n    AccessibleModal.prototype.makeAccessible = function (title) {\n        this.element.setAttribute('aria-modal', 'true');\n        if (title) {\n            this.headerElement.setAttribute('aria-label', title);\n        }\n        this.makeCloseButtonAccessible();\n    };\n    AccessibleModal.prototype.makeCloseButtonAccessible = function () {\n        var closeButton = this.element.querySelector('.coveo-small-close');\n        closeButton.setAttribute('aria-label', Strings_1.l('Close'));\n        closeButton.setAttribute('role', 'button');\n        closeButton.tabIndex = 0;\n        closeButton.focus();\n        Dom_1.$$(closeButton).on('keyup', KeyboardUtils_1.KeyboardUtils.keypressAction(KeyboardUtils_1.KEYBOARD.ENTER, function () { return closeButton.click(); }));\n    };\n    AccessibleModal.prototype.onModalClose = function () {\n        this.focusTrap.disable();\n        this.focusTrap = null;\n        if (this.initiallyFocusedElement && document.body.contains(this.initiallyFocusedElement)) {\n            this.initiallyFocusedElement.focus();\n        }\n    };\n    return AccessibleModal;\n}());\nexports.AccessibleModal = AccessibleModal;\n\n\n/***/ }),\n\n/***/ 295:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ExternalModulesShim_1 = __webpack_require__(26);\nvar GlobalExports_1 = __webpack_require__(3);\nvar Component_1 = __webpack_require__(7);\nvar Core_1 = __webpack_require__(20);\n__webpack_require__(697);\nvar underscore_1 = __webpack_require__(0);\nvar UserFeedbackBanner_1 = __webpack_require__(698);\nvar AnalyticsActionListMeta_1 = __webpack_require__(10);\nvar HeightLimiter_1 = __webpack_require__(699);\nvar ExplanationModal_1 = __webpack_require__(700);\nvar Strings_1 = __webpack_require__(6);\nvar AttachShadowPolyfill_1 = __webpack_require__(517);\nvar Utils_1 = __webpack_require__(4);\nvar reasons = [\n    {\n        analytics: AnalyticsActionListMeta_1.AnalyticsSmartSnippetFeedbackReason.DoesNotAnswer,\n        localeKey: 'UsefulnessFeedbackDoesNotAnswer'\n    },\n    {\n        analytics: AnalyticsActionListMeta_1.AnalyticsSmartSnippetFeedbackReason.PartiallyAnswers,\n        localeKey: 'UsefulnessFeedbackPartiallyAnswers'\n    },\n    {\n        analytics: AnalyticsActionListMeta_1.AnalyticsSmartSnippetFeedbackReason.WasNotAQuestion,\n        localeKey: 'UsefulnessFeedbackWasNotAQuestion'\n    },\n    {\n        analytics: AnalyticsActionListMeta_1.AnalyticsSmartSnippetFeedbackReason.Other,\n        localeKey: 'Other',\n        hasDetails: true\n    }\n];\nvar BASE_CLASSNAME = 'coveo-smart-snippet';\nvar QUESTION_CLASSNAME = BASE_CLASSNAME + \"-question\";\nvar ANSWER_CONTAINER_CLASSNAME = BASE_CLASSNAME + \"-answer\";\nvar HAS_ANSWER_CLASSNAME = BASE_CLASSNAME + \"-has-answer\";\nvar SHADOW_CLASSNAME = BASE_CLASSNAME + \"-content\";\nvar CONTENT_CLASSNAME = BASE_CLASSNAME + \"-content-wrapper\";\nvar SOURCE_CLASSNAME = BASE_CLASSNAME + \"-source\";\nvar SOURCE_TITLE_CLASSNAME = SOURCE_CLASSNAME + \"-title\";\nvar SOURCE_URL_CLASSNAME = SOURCE_CLASSNAME + \"-url\";\nexports.SmartSnippetClassNames = {\n    QUESTION_CLASSNAME: QUESTION_CLASSNAME,\n    ANSWER_CONTAINER_CLASSNAME: ANSWER_CONTAINER_CLASSNAME,\n    HAS_ANSWER_CLASSNAME: HAS_ANSWER_CLASSNAME,\n    SHADOW_CLASSNAME: SHADOW_CLASSNAME,\n    CONTENT_CLASSNAME: CONTENT_CLASSNAME,\n    SOURCE_CLASSNAME: SOURCE_CLASSNAME,\n    SOURCE_TITLE_CLASSNAME: SOURCE_TITLE_CLASSNAME,\n    SOURCE_URL_CLASSNAME: SOURCE_URL_CLASSNAME\n};\nvar SmartSnippet = /** @class */ (function (_super) {\n    __extends(SmartSnippet, _super);\n    function SmartSnippet(element, options, bindings, ModalBox) {\n        if (ModalBox === void 0) { ModalBox = ExternalModulesShim_1.ModalBox; }\n        var _this = _super.call(this, element, SmartSnippet.ID, bindings) || this;\n        _this.element = element;\n        _this.options = options;\n        _this.ModalBox = ModalBox;\n        _this.bind.onRootElement(Core_1.QueryEvents.deferredQuerySuccess, function (data) { return _this.handleQuerySuccess(data); });\n        return _this;\n    }\n    Object.defineProperty(SmartSnippet.prototype, \"style\", {\n        get: function () {\n            return Core_1.$$(this.element)\n                .children()\n                .filter(function (element) { return element instanceof HTMLScriptElement && element.type.toLowerCase() === 'text/css'; })\n                .map(function (element) { return element.innerHTML; })\n                .join('\\n');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SmartSnippet.prototype, \"hasAnswer\", {\n        set: function (hasAnswer) {\n            Core_1.$$(this.element).toggleClass(HAS_ANSWER_CLASSNAME, hasAnswer);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SmartSnippet.prototype.createDom = function () {\n        var _this = this;\n        this.element.appendChild(this.buildAnswerContainer());\n        this.feedbackBanner = new UserFeedbackBanner_1.UserFeedbackBanner(function (isUseful) { return (isUseful ? _this.sendLikeSmartSnippetAnalytics() : _this.sendDislikeSmartSnippetAnalytics()); }, function () { return _this.openExplanationModal(); });\n        this.element.appendChild(this.feedbackBanner.build());\n        this.explanationModal = new ExplanationModal_1.ExplanationModal({\n            reasons: reasons.map(function (reason) {\n                return ({\n                    label: Strings_1.l(reason.localeKey),\n                    id: reason.analytics.replace(/_/g, '-'),\n                    onSelect: function () { return _this.sendExplanationAnalytics(reason.analytics, _this.explanationModal.details); },\n                    hasDetails: reason.hasDetails\n                });\n            }),\n            onClosed: function () { return _this.sendCloseFeedbackModalAnalytics(); },\n            ownerElement: this.searchInterface.options.modalContainer,\n            modalBoxModule: this.ModalBox\n        });\n    };\n    SmartSnippet.prototype.buildAnswerContainer = function () {\n        return Core_1.$$('div', {\n            className: ANSWER_CONTAINER_CLASSNAME\n        }, this.buildQuestion(), this.buildShadow(), this.buildHeightLimiter(), this.buildSourceContainer()).el;\n    };\n    SmartSnippet.prototype.buildQuestion = function () {\n        return (this.questionContainer = Core_1.$$('div', { className: QUESTION_CLASSNAME }).el);\n    };\n    SmartSnippet.prototype.buildShadow = function () {\n        var _this = this;\n        this.shadowContainer = Core_1.$$('div', { className: SHADOW_CLASSNAME }).el;\n        this.snippetContainer = Core_1.$$('section', { className: CONTENT_CLASSNAME }).el;\n        this.shadowLoading = AttachShadowPolyfill_1.attachShadow(this.shadowContainer, { mode: 'open', title: Strings_1.l('AnswerSnippet') }).then(function (shadow) {\n            shadow.appendChild(_this.snippetContainer);\n            var style = _this.buildStyle();\n            if (style) {\n                shadow.appendChild(style);\n            }\n            return shadow;\n        });\n        return this.shadowContainer;\n    };\n    SmartSnippet.prototype.buildHeightLimiter = function () {\n        var _this = this;\n        return (this.heightLimiter = new HeightLimiter_1.HeightLimiter(this.shadowContainer, this.snippetContainer, 400, function (isExpanded) {\n            return isExpanded ? _this.sendExpandSmartSnippetAnalytics() : _this.sendCollapseSmartSnippetAnalytics();\n        })).toggleButton;\n    };\n    SmartSnippet.prototype.buildSourceContainer = function () {\n        return (this.sourceContainer = Core_1.$$('div', { className: SOURCE_CLASSNAME }).el);\n    };\n    SmartSnippet.prototype.buildStyle = function () {\n        var style = this.style;\n        if (!style) {\n            return;\n        }\n        var styleTag = document.createElement('style');\n        styleTag.innerHTML = style;\n        return styleTag;\n    };\n    /**\n     * @warning This method only works for the demo. In practice, the source of the answer will not always be part of the results.\n     */\n    SmartSnippet.prototype.getCorrespondingResult = function (questionAnswer) {\n        return underscore_1.find(this.queryController.getLastResults().results, function (result) { return result.raw[questionAnswer.documentId.contentIdKey] === questionAnswer.documentId.contentIdValue; });\n    };\n    SmartSnippet.prototype.handleQuerySuccess = function (data) {\n        return __awaiter(this, void 0, void 0, function () {\n            var questionAnswer;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        questionAnswer = data.results.questionAnswer;\n                        if (!questionAnswer) {\n                            this.hasAnswer = false;\n                            return [2 /*return*/];\n                        }\n                        this.hasAnswer = true;\n                        return [4 /*yield*/, this.render(questionAnswer)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    SmartSnippet.prototype.render = function (questionAnswer) {\n        return __awaiter(this, void 0, void 0, function () {\n            var lastRenderedResult;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        this.ensureDom();\n                        this.questionContainer.innerText = questionAnswer.question;\n                        this.renderSnippet(questionAnswer.answerSnippet);\n                        lastRenderedResult = this.getCorrespondingResult(questionAnswer);\n                        if (lastRenderedResult) {\n                            this.renderSource(lastRenderedResult);\n                        }\n                        return [4 /*yield*/, this.shadowLoading];\n                    case 1:\n                        _a.sent();\n                        return [4 /*yield*/, Utils_1.Utils.resolveAfter(0)];\n                    case 2:\n                        _a.sent(); // `scrollHeight` isn't instantly detected, or at-least not on IE11.\n                        this.heightLimiter.onContentHeightChanged();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    SmartSnippet.prototype.renderSnippet = function (content) {\n        this.snippetContainer.innerHTML = content;\n    };\n    SmartSnippet.prototype.renderSource = function (source) {\n        Core_1.$$(this.sourceContainer).empty();\n        this.sourceContainer.appendChild(this.renderSourceUrl(source.clickUri));\n        this.sourceContainer.appendChild(this.renderSourceTitle(source.title, source.clickUri));\n    };\n    SmartSnippet.prototype.renderSourceTitle = function (title, clickUri) {\n        return this.renderLink(title, clickUri, SOURCE_TITLE_CLASSNAME);\n    };\n    SmartSnippet.prototype.renderSourceUrl = function (url) {\n        return this.renderLink(url, url, SOURCE_URL_CLASSNAME);\n    };\n    SmartSnippet.prototype.renderLink = function (text, href, className) {\n        var _this = this;\n        var element = Core_1.$$('a', { className: className, href: href }).el;\n        element.innerText = text;\n        this.enableAnalyticsOnLink(element, function () { return _this.sendOpenSourceAnalytics(); });\n        return element;\n    };\n    SmartSnippet.prototype.enableAnalyticsOnLink = function (link, sendAnalytics) {\n        var _this = this;\n        link.addEventListener('click', function (e) {\n            e.preventDefault();\n            _this.openLink(link.href, e.ctrlKey, sendAnalytics);\n        });\n    };\n    SmartSnippet.prototype.openLink = function (href, newTab, sendAnalytics) {\n        sendAnalytics();\n        if (newTab) {\n            window.open(href);\n        }\n        else {\n            window.location.href = href;\n        }\n    };\n    SmartSnippet.prototype.openExplanationModal = function () {\n        this.sendOpenFeedbackModalAnalytics();\n        this.explanationModal.open(this.feedbackBanner.explainWhy);\n    };\n    SmartSnippet.prototype.sendLikeSmartSnippetAnalytics = function () {\n        return this.usageAnalytics.logCustomEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.likeSmartSnippet, {}, this.element, this.lastRenderedResult);\n    };\n    SmartSnippet.prototype.sendDislikeSmartSnippetAnalytics = function () {\n        return this.usageAnalytics.logCustomEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.dislikeSmartSnippet, {}, this.element, this.lastRenderedResult);\n    };\n    SmartSnippet.prototype.sendExpandSmartSnippetAnalytics = function () {\n        return this.usageAnalytics.logCustomEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.expandSmartSnippet, {}, this.element, this.lastRenderedResult);\n    };\n    SmartSnippet.prototype.sendCollapseSmartSnippetAnalytics = function () {\n        return this.usageAnalytics.logCustomEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.collapseSmartSnippet, {}, this.element, this.lastRenderedResult);\n    };\n    SmartSnippet.prototype.sendOpenSourceAnalytics = function () {\n        return this.usageAnalytics.logCustomEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.openSmartSnippetSource, {}, this.element, this.lastRenderedResult);\n    };\n    SmartSnippet.prototype.sendOpenFeedbackModalAnalytics = function () {\n        return this.usageAnalytics.logCustomEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.openSmartSnippetFeedbackModal, {}, this.element, this.lastRenderedResult);\n    };\n    SmartSnippet.prototype.sendCloseFeedbackModalAnalytics = function () {\n        return this.usageAnalytics.logCustomEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.closeSmartSnippetFeedbackModal, {}, this.element, this.lastRenderedResult);\n    };\n    SmartSnippet.prototype.sendExplanationAnalytics = function (reason, details) {\n        return this.usageAnalytics.logCustomEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.sendSmartSnippetReason, {\n            reason: reason,\n            details: details\n        }, this.element, this.lastRenderedResult);\n    };\n    SmartSnippet.ID = 'SmartSnippet';\n    SmartSnippet.doExport = function () {\n        GlobalExports_1.exportGlobally({\n            SmartSnippet: SmartSnippet\n        });\n    };\n    return SmartSnippet;\n}(Component_1.Component));\nexports.SmartSnippet = SmartSnippet;\nCore_1.Initialization.registerAutoCreateComponent(SmartSnippet);\n\n\n/***/ }),\n\n/***/ 465:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Defer_1 = __webpack_require__(31);\nvar underscore_1 = __webpack_require__(0);\nvar Dom_1 = __webpack_require__(1);\nvar FocusTrap = /** @class */ (function () {\n    function FocusTrap(container) {\n        this.container = container;\n        this.hiddenElements = [];\n        this.enable();\n    }\n    Object.defineProperty(FocusTrap.prototype, \"focusableElements\", {\n        get: function () {\n            return underscore_1.sortBy(this.container.querySelectorAll('[tabindex]'), function (element) { return element.tabIndex; });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    FocusTrap.prototype.disable = function () {\n        document.removeEventListener('focusin', this.focusInEvent);\n        document.removeEventListener('focusout', this.focusOutEvent);\n        this.showHiddenElements();\n        this.enabled = false;\n    };\n    FocusTrap.prototype.enable = function () {\n        var _this = this;\n        document.addEventListener('focusin', (this.focusInEvent = function (e) { return _this.onFocusIn(e); }));\n        document.addEventListener('focusout', (this.focusOutEvent = function (e) { return _this.onFocusOut(e); }));\n        this.hideAllExcept(this.container);\n        this.enabled = true;\n    };\n    FocusTrap.prototype.showHiddenElements = function () {\n        while (this.hiddenElements.length) {\n            this.hiddenElements.pop().removeAttribute('aria-hidden');\n        }\n    };\n    FocusTrap.prototype.hideElement = function (element) {\n        if (element.getAttribute('aria-hidden')) {\n            return;\n        }\n        this.hiddenElements.push(element);\n        element.setAttribute('aria-hidden', \"\" + true);\n    };\n    FocusTrap.prototype.hideSiblings = function (allowedElement) {\n        var _this = this;\n        var parent = allowedElement.parentElement;\n        if (parent) {\n            underscore_1.without(Dom_1.$$(parent).children(), allowedElement).forEach(function (elementToHide) {\n                _this.hideElement(elementToHide);\n            });\n        }\n    };\n    FocusTrap.prototype.hideAllExcept = function (allowedElement) {\n        this.hideSiblings(allowedElement);\n        var parent = allowedElement.parentElement;\n        if (parent && parent !== document.body) {\n            this.hideAllExcept(parent);\n        }\n    };\n    FocusTrap.prototype.getFocusableSibling = function (element, previous) {\n        if (previous === void 0) { previous = false; }\n        var elements = this.focusableElements;\n        var currentIndex = elements.indexOf(element);\n        if (currentIndex === -1) {\n            return null;\n        }\n        return elements[(currentIndex + (previous ? -1 : 1) + elements.length) % elements.length];\n    };\n    FocusTrap.prototype.focusSibling = function (element, previous) {\n        if (previous === void 0) { previous = false; }\n        var sibling = this.getFocusableSibling(element, previous);\n        if (sibling) {\n            sibling.focus();\n        }\n    };\n    FocusTrap.prototype.focusFirstElement = function () {\n        var elements = this.focusableElements;\n        if (elements.length) {\n            elements[0].focus();\n        }\n    };\n    FocusTrap.prototype.elementIsBefore = function (oldElement, newElement) {\n        if (!newElement) {\n            return false;\n        }\n        return oldElement.compareDocumentPosition(newElement) === Node.DOCUMENT_POSITION_PRECEDING;\n    };\n    FocusTrap.prototype.onLosingFocus = function (oldElement, newElement) {\n        var _this = this;\n        Defer_1.Defer.defer(function () {\n            if (!_this.enabled) {\n                return;\n            }\n            _this.enabled = false;\n            if (oldElement && _this.focusIsAllowed(oldElement)) {\n                _this.focusSibling(oldElement, _this.elementIsBefore(oldElement, newElement));\n            }\n            else {\n                _this.focusFirstElement();\n            }\n            _this.enabled = true;\n        });\n    };\n    FocusTrap.prototype.focusIsAllowed = function (element) {\n        return this.container.contains(element);\n    };\n    FocusTrap.prototype.elementIsInPage = function (element) {\n        return element && element !== document.body.parentElement;\n    };\n    FocusTrap.prototype.onFocusIn = function (e) {\n        if (!this.enabled) {\n            return;\n        }\n        var oldElement = e.relatedTarget;\n        var handledByFocusOut = this.elementIsInPage(oldElement);\n        if (handledByFocusOut) {\n            return;\n        }\n        var newElement = e.target;\n        if (!this.elementIsInPage(newElement)) {\n            return;\n        }\n        if (!this.focusIsAllowed(newElement)) {\n            this.onLosingFocus(null, newElement);\n        }\n    };\n    FocusTrap.prototype.onFocusOut = function (e) {\n        if (!this.enabled) {\n            return;\n        }\n        var newElement = e.relatedTarget;\n        if (!this.elementIsInPage(newElement)) {\n            return;\n        }\n        if (!newElement || !this.focusIsAllowed(newElement)) {\n            this.onLosingFocus(e.target, newElement);\n        }\n    };\n    return FocusTrap;\n}());\nexports.FocusTrap = FocusTrap;\n\n\n/***/ }),\n\n/***/ 517:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Dom_1 = __webpack_require__(1);\n__webpack_require__(582);\nfunction attachShadow(element, init) {\n    return __awaiter(this, void 0, void 0, function () {\n        var iframe, onLoad, iframeBody, shadowRoot;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    iframe = Dom_1.$$('iframe', { className: 'coveo-shadow-iframe', scrolling: 'no', title: init.title }).el;\n                    onLoad = new Promise(function (resolve) { return iframe.addEventListener('load', function () { return resolve(); }); });\n                    element.appendChild(iframe);\n                    return [4 /*yield*/, onLoad];\n                case 1:\n                    _a.sent();\n                    iframeBody = iframe.contentDocument.body;\n                    iframeBody.style.margin = '0';\n                    shadowRoot = Dom_1.$$('div', { style: 'overflow: auto;' }).el;\n                    iframeBody.appendChild(shadowRoot);\n                    autoUpdateHeight(iframe, shadowRoot);\n                    if (init.mode === 'open') {\n                        Object.defineProperty(element, 'shadowRoot', { get: function () { return shadowRoot; } });\n                    }\n                    return [2 /*return*/, shadowRoot];\n            }\n        });\n    });\n}\nexports.attachShadow = attachShadow;\nfunction autoUpdateHeight(elementToResize, content) {\n    var heightObserver = new MutationObserver(function () {\n        elementToResize.style.height = content.clientHeight + \"px\";\n    });\n    heightObserver.observe(content, {\n        attributes: true,\n        characterData: true,\n        childList: true,\n        subtree: true\n    });\n}\n\n\n/***/ }),\n\n/***/ 555:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 582:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 697:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 698:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Dom_1 = __webpack_require__(1);\nvar Strings_1 = __webpack_require__(6);\nvar SVGIcons_1 = __webpack_require__(12);\nvar underscore_1 = __webpack_require__(0);\nvar ROOT_CLASSNAME = 'coveo-user-feedback-banner';\nvar CONTAINER_CLASSNAME = ROOT_CLASSNAME + \"-container\";\nvar LABEL_CLASSNAME = ROOT_CLASSNAME + \"-label\";\nvar BUTTONS_CONTAINER_CLASSNAME = ROOT_CLASSNAME + \"-buttons\";\nvar YES_BUTTON_CLASSNAME = ROOT_CLASSNAME + \"-yes-button\";\nvar NO_BUTTON_CLASSNAME = ROOT_CLASSNAME + \"-no-button\";\nvar BUTTON_ACTIVE_CLASSNAME = ROOT_CLASSNAME + \"-button-active\";\nvar THANK_YOU_BANNER_CLASSNAME = ROOT_CLASSNAME + \"-thanks\";\nvar THANK_YOU_BANNER_ACTIVE_CLASSNAME = THANK_YOU_BANNER_CLASSNAME + \"-active\";\nvar ICON_CLASSNAME = THANK_YOU_BANNER_CLASSNAME + \"-icon\";\nvar EXPLAIN_WHY_CLASSNAME = ROOT_CLASSNAME + \"-explain-why\";\nvar EXPLAIN_WHY_ACTIVE_CLASSNAME = EXPLAIN_WHY_CLASSNAME + \"-active\";\nvar UsefulState;\n(function (UsefulState) {\n    UsefulState[UsefulState[\"Unknown\"] = 0] = \"Unknown\";\n    UsefulState[UsefulState[\"Yes\"] = 1] = \"Yes\";\n    UsefulState[UsefulState[\"No\"] = 2] = \"No\";\n})(UsefulState || (UsefulState = {}));\nexports.UserFeedbackBannerClassNames = {\n    ROOT_CLASSNAME: ROOT_CLASSNAME,\n    CONTAINER_CLASSNAME: CONTAINER_CLASSNAME,\n    LABEL_CLASSNAME: LABEL_CLASSNAME,\n    BUTTONS_CONTAINER_CLASSNAME: BUTTONS_CONTAINER_CLASSNAME,\n    YES_BUTTON_CLASSNAME: YES_BUTTON_CLASSNAME,\n    NO_BUTTON_CLASSNAME: NO_BUTTON_CLASSNAME,\n    BUTTON_ACTIVE_CLASSNAME: BUTTON_ACTIVE_CLASSNAME,\n    THANK_YOU_BANNER_CLASSNAME: THANK_YOU_BANNER_CLASSNAME,\n    THANK_YOU_BANNER_ACTIVE_CLASSNAME: THANK_YOU_BANNER_ACTIVE_CLASSNAME,\n    ICON_CLASSNAME: ICON_CLASSNAME,\n    EXPLAIN_WHY_CLASSNAME: EXPLAIN_WHY_CLASSNAME,\n    EXPLAIN_WHY_ACTIVE_CLASSNAME: EXPLAIN_WHY_ACTIVE_CLASSNAME\n};\nvar UserFeedbackBanner = /** @class */ (function () {\n    function UserFeedbackBanner(sendUsefulnessAnalytics, onExplainWhyPressed) {\n        this.sendUsefulnessAnalytics = sendUsefulnessAnalytics;\n        this.onExplainWhyPressed = onExplainWhyPressed;\n        this.isUseful = UsefulState.Unknown;\n        this.labelId = underscore_1.uniqueId(LABEL_CLASSNAME);\n    }\n    UserFeedbackBanner.prototype.build = function () {\n        return Dom_1.$$('div', {\n            className: ROOT_CLASSNAME,\n            ariaLive: 'polite'\n        }, this.buildContainer(), this.buildThankYouBanner()).el;\n    };\n    UserFeedbackBanner.prototype.buildContainer = function () {\n        return Dom_1.$$('div', {\n            className: CONTAINER_CLASSNAME,\n            ariaLabelledby: this.labelId\n        }, this.buildLabel(), this.buildButtons()).el;\n    };\n    UserFeedbackBanner.prototype.buildLabel = function () {\n        return Dom_1.$$('span', { className: LABEL_CLASSNAME, id: this.labelId }, Strings_1.l('UsefulnessFeedbackRequest')).el;\n    };\n    UserFeedbackBanner.prototype.buildThankYouBanner = function () {\n        var _this = this;\n        this.thankYouBanner = Dom_1.$$('div', { className: THANK_YOU_BANNER_CLASSNAME }).el;\n        var text = Dom_1.$$('span', {}, Strings_1.l('UsefulnessFeedbackThankYou')).el;\n        this.thankYouBanner.appendChild(text);\n        this.explainWhy = this.buildButton({\n            text: Strings_1.l('UsefulnessFeedbackExplainWhy'),\n            className: EXPLAIN_WHY_CLASSNAME,\n            action: function () { return _this.requestExplaination(); }\n        });\n        this.thankYouBanner.appendChild(this.explainWhy);\n        return this.thankYouBanner;\n    };\n    UserFeedbackBanner.prototype.buildButtons = function () {\n        var _this = this;\n        var buttonsContainer = Dom_1.$$('div', { className: BUTTONS_CONTAINER_CLASSNAME }).el;\n        this.yesButton = this.buildButton({\n            text: Strings_1.l('Yes'),\n            className: YES_BUTTON_CLASSNAME,\n            action: function () { return _this.showThankYouBanner(true); },\n            icon: {\n                className: ICON_CLASSNAME,\n                content: SVGIcons_1.SVGIcons.icons.checkYes\n            },\n            attributes: {\n                ariaPressed: false,\n                ariaDescribedby: this.labelId\n            }\n        });\n        this.yesButton.setAttribute('aria-pressed', 'false');\n        buttonsContainer.appendChild(this.yesButton);\n        this.noButton = this.buildButton({\n            text: Strings_1.l('No'),\n            className: NO_BUTTON_CLASSNAME,\n            action: function () { return _this.showThankYouBanner(false); },\n            icon: {\n                className: ICON_CLASSNAME,\n                content: SVGIcons_1.SVGIcons.icons.clearSmall\n            },\n            attributes: {\n                ariaPressed: false,\n                ariaDescribedby: this.labelId\n            }\n        });\n        buttonsContainer.appendChild(this.noButton);\n        return buttonsContainer;\n    };\n    UserFeedbackBanner.prototype.buildButton = function (options) {\n        var button = Dom_1.$$('button', __assign({}, (options.attributes || {}), { className: options.className })).el;\n        if (options.icon) {\n            var icon = Dom_1.$$('span', { className: options.icon.className }, options.icon.content).el;\n            button.appendChild(icon);\n            var text = Dom_1.$$('span', {}, options.text).el;\n            button.appendChild(text);\n        }\n        else {\n            button.innerText = options.text;\n        }\n        button.addEventListener('click', function () { return options.action(); });\n        return button;\n    };\n    UserFeedbackBanner.prototype.showThankYouBanner = function (isUseful) {\n        if (this.isUseful !== UsefulState.Unknown && isUseful === (this.isUseful === UsefulState.Yes)) {\n            return;\n        }\n        this.isUseful = isUseful ? UsefulState.Yes : UsefulState.No;\n        Dom_1.$$(this.yesButton).toggleClass(BUTTON_ACTIVE_CLASSNAME, isUseful);\n        Dom_1.$$(this.yesButton).setAttribute('aria-pressed', \"\" + isUseful);\n        Dom_1.$$(this.noButton).toggleClass(BUTTON_ACTIVE_CLASSNAME, !isUseful);\n        Dom_1.$$(this.noButton).setAttribute('aria-pressed', \"\" + !isUseful);\n        Dom_1.$$(this.thankYouBanner).addClass(THANK_YOU_BANNER_ACTIVE_CLASSNAME);\n        Dom_1.$$(this.explainWhy).toggleClass(EXPLAIN_WHY_ACTIVE_CLASSNAME, !isUseful);\n        this.sendUsefulnessAnalytics(isUseful);\n    };\n    UserFeedbackBanner.prototype.requestExplaination = function () {\n        this.onExplainWhyPressed();\n    };\n    return UserFeedbackBanner;\n}());\nexports.UserFeedbackBanner = UserFeedbackBanner;\n\n\n/***/ }),\n\n/***/ 699:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Dom_1 = __webpack_require__(1);\nvar SVGIcons_1 = __webpack_require__(12);\nvar Strings_1 = __webpack_require__(6);\nvar BASE_CLASSNAME = 'coveo-height-limiter';\nvar CONTAINER_ACTIVE_CLASSNAME = BASE_CLASSNAME + \"-container-active\";\nvar CONTAINER_EXPANDED_CLASSNAME = BASE_CLASSNAME + \"-container-expanded\";\nvar BUTTON_CLASSNAME = BASE_CLASSNAME + \"-button\";\nvar BUTTON_LABEL_CLASSNAME = BUTTON_CLASSNAME + \"-label\";\nvar BUTTON_ICON_CLASSNAME = BUTTON_CLASSNAME + \"-icon\";\nvar BUTTON_ACTIVE_CLASSNAME = BUTTON_CLASSNAME + \"-active\";\nexports.HeightLimiterClassNames = {\n    CONTAINER_ACTIVE_CLASSNAME: CONTAINER_ACTIVE_CLASSNAME,\n    CONTAINER_EXPANDED_CLASSNAME: CONTAINER_EXPANDED_CLASSNAME,\n    BUTTON_CLASSNAME: BUTTON_CLASSNAME,\n    BUTTON_LABEL_CLASSNAME: BUTTON_LABEL_CLASSNAME,\n    BUTTON_ICON_CLASSNAME: BUTTON_ICON_CLASSNAME,\n    BUTTON_ACTIVE_CLASSNAME: BUTTON_ACTIVE_CLASSNAME\n};\nvar HeightLimiter = /** @class */ (function () {\n    function HeightLimiter(containerElement, contentElement, heightLimit, onToggle) {\n        this.containerElement = containerElement;\n        this.contentElement = contentElement;\n        this.heightLimit = heightLimit;\n        this.onToggle = onToggle;\n        this.isExpanded = false;\n        this.buildButton();\n        this.updateActiveAppearance();\n    }\n    Object.defineProperty(HeightLimiter.prototype, \"toggleButton\", {\n        get: function () {\n            return this.button;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HeightLimiter.prototype, \"height\", {\n        set: function (height) {\n            this.containerElement.style.height = height + \"px\";\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HeightLimiter.prototype, \"contentHeight\", {\n        get: function () {\n            return this.contentElement.clientHeight;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    HeightLimiter.prototype.onContentHeightChanged = function () {\n        this.updateActiveAppearance();\n    };\n    HeightLimiter.prototype.buildButton = function () {\n        var _this = this;\n        this.button = Dom_1.$$('button', { className: BUTTON_CLASSNAME, ariaLabel: Strings_1.l('ShowMore'), ariaPressed: 'false', ariaHidden: 'true' }, (this.buttonLabel = Dom_1.$$('span', { className: BUTTON_LABEL_CLASSNAME }).el), (this.buttonIcon = Dom_1.$$('span', { className: BUTTON_ICON_CLASSNAME }).el)).el;\n        this.button.addEventListener('click', function () { return _this.toggle(); });\n        this.updateButton();\n        return this.button;\n    };\n    HeightLimiter.prototype.updateActiveAppearance = function () {\n        var shouldBeActive = this.contentHeight > this.heightLimit;\n        Dom_1.$$(this.containerElement).toggleClass(CONTAINER_ACTIVE_CLASSNAME, shouldBeActive);\n        Dom_1.$$(this.button).toggleClass(BUTTON_ACTIVE_CLASSNAME, shouldBeActive);\n        if (shouldBeActive) {\n            this.updateExpandedAppearance();\n        }\n        else {\n            this.isExpanded = false;\n            this.updateExpandedAppearance();\n            this.containerElement.style.height = '';\n        }\n    };\n    HeightLimiter.prototype.updateButton = function () {\n        this.buttonLabel.innerText = this.isExpanded ? Strings_1.l('ShowLess') : Strings_1.l('ShowMore');\n        this.button.setAttribute('aria-pressed', \"\" + this.isExpanded);\n        this.buttonIcon.innerHTML = this.isExpanded ? SVGIcons_1.SVGIcons.icons.arrowUp : SVGIcons_1.SVGIcons.icons.arrowDown;\n    };\n    HeightLimiter.prototype.updateExpandedAppearance = function () {\n        this.updateButton();\n        Dom_1.$$(this.containerElement).toggleClass(CONTAINER_EXPANDED_CLASSNAME, this.isExpanded);\n        this.height = this.isExpanded ? this.contentHeight : this.heightLimit;\n    };\n    HeightLimiter.prototype.toggle = function () {\n        this.isExpanded = !this.isExpanded;\n        this.updateExpandedAppearance();\n        if (this.onToggle) {\n            this.onToggle(this.isExpanded);\n        }\n    };\n    return HeightLimiter;\n}());\nexports.HeightLimiter = HeightLimiter;\n\n\n/***/ }),\n\n/***/ 700:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar AccessibleModal_1 = __webpack_require__(220);\nvar Strings_1 = __webpack_require__(6);\nvar Dom_1 = __webpack_require__(1);\nvar RadioButton_1 = __webpack_require__(94);\n__webpack_require__(701);\nvar ROOT_CLASSNAME = 'coveo-user-explanation-modal';\nvar CONTENT_CLASSNAME = ROOT_CLASSNAME + \"-content\";\nvar EXPLANATION_SECTION_CLASSNAME = ROOT_CLASSNAME + \"-explanation-section\";\nvar REASONS_CLASSNAME = ROOT_CLASSNAME + \"-explanations\";\nvar REASONS_LABEL_CLASSNAME = REASONS_CLASSNAME + \"-label\";\nvar DETAILS_SECTION_CLASSNAME = ROOT_CLASSNAME + \"-details\";\nvar DETAILS_TEXTAREA_CLASSNAME = DETAILS_SECTION_CLASSNAME + \"-textarea\";\nvar DETAILS_LABEL_CLASSNAME = DETAILS_SECTION_CLASSNAME + \"-label\";\nvar BUTTONS_SECTION_CLASSNAME = ROOT_CLASSNAME + \"-buttons-section\";\nvar SEND_BUTTON_CLASSNAME = ROOT_CLASSNAME + \"-send-button\";\nvar CANCEL_BUTTON_CLASSNAME = ROOT_CLASSNAME + \"-cancel-button\";\nvar DETAILS_ID = DETAILS_SECTION_CLASSNAME;\nexports.ExplanationModalClassNames = {\n    ROOT_CLASSNAME: ROOT_CLASSNAME,\n    CONTENT_CLASSNAME: CONTENT_CLASSNAME,\n    EXPLANATION_SECTION_CLASSNAME: EXPLANATION_SECTION_CLASSNAME,\n    REASONS_CLASSNAME: REASONS_CLASSNAME,\n    REASONS_LABEL_CLASSNAME: REASONS_LABEL_CLASSNAME,\n    DETAILS_SECTION_CLASSNAME: DETAILS_SECTION_CLASSNAME,\n    DETAILS_TEXTAREA_CLASSNAME: DETAILS_TEXTAREA_CLASSNAME,\n    DETAILS_LABEL_CLASSNAME: DETAILS_LABEL_CLASSNAME,\n    BUTTONS_SECTION_CLASSNAME: BUTTONS_SECTION_CLASSNAME,\n    SEND_BUTTON_CLASSNAME: SEND_BUTTON_CLASSNAME,\n    CANCEL_BUTTON_CLASSNAME: CANCEL_BUTTON_CLASSNAME\n};\nvar ExplanationModal = /** @class */ (function () {\n    function ExplanationModal(options) {\n        this.options = options;\n        this.shouldCallCloseEvent = false;\n        this.modal = new AccessibleModal_1.AccessibleModal(ROOT_CLASSNAME, this.options.ownerElement, this.options.modalBoxModule);\n    }\n    Object.defineProperty(ExplanationModal.prototype, \"details\", {\n        get: function () {\n            if (!this.selectedReason || !this.selectedReason.hasDetails) {\n                return null;\n            }\n            return this.detailsTextArea.value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ExplanationModal.prototype.open = function (origin) {\n        var _this = this;\n        this.modal.open({\n            origin: origin,\n            title: Strings_1.l('UsefulnessFeedbackExplainWhyImperative'),\n            content: this.buildContent(),\n            validation: function () {\n                if (_this.shouldCallCloseEvent) {\n                    _this.options.onClosed();\n                    _this.shouldCallCloseEvent = false;\n                }\n                return true;\n            }\n        });\n        this.shouldCallCloseEvent = true;\n    };\n    ExplanationModal.prototype.buildContent = function () {\n        return Dom_1.$$('div', {\n            className: CONTENT_CLASSNAME\n        }, this.buildExplanationSection(), this.buildButtonsSection()).el;\n    };\n    ExplanationModal.prototype.buildExplanationSection = function () {\n        var detailsSection = this.buildDetailsSection();\n        return Dom_1.$$('div', {\n            className: EXPLANATION_SECTION_CLASSNAME\n        }, this.buildReasons(), detailsSection).el;\n    };\n    ExplanationModal.prototype.buildButtonsSection = function () {\n        return Dom_1.$$('div', {\n            className: BUTTONS_SECTION_CLASSNAME\n        }, this.buildSendButton(), this.buildCancelButton());\n    };\n    ExplanationModal.prototype.buildReasons = function () {\n        var _this = this;\n        var reasonsContainer = Dom_1.$$('fieldset', { className: REASONS_CLASSNAME }, this.buildReasonsLabel()).el;\n        this.reasons = this.options.reasons.map(function (reason) { return _this.buildReasonRadioButton(reason); });\n        this.reasons[0].select();\n        this.reasons.forEach(function (radioButton) { return reasonsContainer.appendChild(radioButton.getElement()); });\n        return reasonsContainer;\n    };\n    ExplanationModal.prototype.buildReasonsLabel = function () {\n        return Dom_1.$$('legend', { className: REASONS_LABEL_CLASSNAME }, Strings_1.l('UsefulnessFeedbackReason')).el;\n    };\n    ExplanationModal.prototype.buildDetailsSection = function () {\n        return Dom_1.$$('div', { className: DETAILS_SECTION_CLASSNAME }, Dom_1.$$('label', { className: DETAILS_LABEL_CLASSNAME, for: DETAILS_ID }, Strings_1.l('Details')).el, (this.detailsTextArea = Dom_1.$$('textarea', { className: DETAILS_TEXTAREA_CLASSNAME, id: DETAILS_ID, disabled: true })\n            .el));\n    };\n    ExplanationModal.prototype.buildSendButton = function () {\n        var _this = this;\n        var button = Dom_1.$$('button', { className: SEND_BUTTON_CLASSNAME }, Strings_1.l('Send'));\n        button.on('click', function () {\n            _this.selectedReason.onSelect();\n            _this.shouldCallCloseEvent = false;\n            _this.modal.close();\n        });\n        return button.el;\n    };\n    ExplanationModal.prototype.buildCancelButton = function () {\n        var _this = this;\n        var button = Dom_1.$$('button', { className: CANCEL_BUTTON_CLASSNAME }, Strings_1.l('Cancel'));\n        button.on('click', function () { return _this.modal.close(); });\n        return button.el;\n    };\n    ExplanationModal.prototype.buildReasonRadioButton = function (reason) {\n        var _this = this;\n        return new RadioButton_1.RadioButton(function (radioButton) {\n            if (!radioButton.isSelected()) {\n                return;\n            }\n            _this.detailsTextArea.disabled = !reason.hasDetails;\n            _this.selectedReason = reason;\n        }, reason.label, 'reason', \"coveo-reason-\" + reason.id);\n    };\n    return ExplanationModal;\n}());\nexports.ExplanationModal = ExplanationModal;\n\n\n/***/ }),\n\n/***/ 701:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 94:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Dom_1 = __webpack_require__(1);\n__webpack_require__(555);\nvar GlobalExports_1 = __webpack_require__(3);\n/**\n * A radio button widget with standard styling.\n */\nvar RadioButton = /** @class */ (function () {\n    /**\n     * Creates a new `RadioButton`.\n     * @param onChange The function to call when the radio button value changes. This function takes the current\n     * `RadioButton` instance as an argument.\n     * @param label The label to display next to the radio button.\n     * @param name The value to set the `input` HTMLElement `name` attribute to.\n     */\n    function RadioButton(onChange, label, name, id) {\n        if (onChange === void 0) { onChange = function (radioButton) { }; }\n        if (id === void 0) { id = label; }\n        this.onChange = onChange;\n        this.label = label;\n        this.name = name;\n        this.id = id;\n        this.buildContent();\n    }\n    RadioButton.doExport = function () {\n        GlobalExports_1.exportGlobally({\n            RadioButton: RadioButton\n        });\n    };\n    /**\n     * Resets the radio button.\n     */\n    RadioButton.prototype.reset = function () {\n        var currentlySelected = this.isSelected();\n        this.getRadio().checked = false;\n        if (currentlySelected) {\n            this.onChange(this);\n        }\n    };\n    /**\n     * Select the radio button\n     * @param triggerChange will trigger change event if specified and the radio button is not already selected\n     */\n    RadioButton.prototype.select = function (triggerChange) {\n        if (triggerChange === void 0) { triggerChange = true; }\n        var currentlySelected = this.isSelected();\n        this.getRadio().checked = true;\n        if (!currentlySelected && triggerChange) {\n            this.onChange(this);\n        }\n    };\n    /**\n     * Gets the element on which the radio button is bound.\n     * @returns {HTMLElement} The radio button element.\n     */\n    RadioButton.prototype.build = function () {\n        return this.element;\n    };\n    /**\n     * Gets the element on which the radio button is bound.\n     * @returns {HTMLElement} The radio button element.\n     */\n    RadioButton.prototype.getElement = function () {\n        return this.element;\n    };\n    RadioButton.prototype.getValue = function () {\n        return this.label;\n    };\n    /**\n     * Indicates whether the radio button is selected.\n     * @returns {boolean} `true` if the radio button is selected, `false` otherwise.\n     */\n    RadioButton.prototype.isSelected = function () {\n        return this.getRadio().checked;\n    };\n    /**\n     * Gets the `input` element (the radio button itself).\n     * @returns {HTMLInputElement} The `input` element.\n     */\n    RadioButton.prototype.getRadio = function () {\n        return Dom_1.$$(this.element).find('input');\n    };\n    /**\n     * Gets the radio button [`label`]{@link RadioButton.label} element.\n     * @returns {HTMLLabelElement} The `label` element.\n     */\n    RadioButton.prototype.getLabel = function () {\n        return Dom_1.$$(this.element).find('label');\n    };\n    RadioButton.prototype.buildContent = function () {\n        var _this = this;\n        var radioOption = Dom_1.$$('div', { className: 'coveo-radio' });\n        var radioInput = Dom_1.$$('input', { type: 'radio', name: this.name, id: this.id });\n        var labelInput = Dom_1.$$('label', { className: 'coveo-radio-input-label', for: this.id });\n        labelInput.text(this.label);\n        radioInput.on('change', function () {\n            _this.onChange(_this);\n        });\n        radioOption.append(radioInput.el);\n        radioOption.append(labelInput.el);\n        this.element = radioOption.el;\n    };\n    return RadioButton;\n}());\nexports.RadioButton = RadioButton;\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// SmartSnippet.min__45edc409d97327d59af1.js","import { ModalBox as ModalBoxModule } from '../ExternalModulesShim';\nimport { FocusTrap } from '../ui/FocusTrap/FocusTrap';\nimport { l } from '../strings/Strings';\nimport { $$ } from './Dom';\nimport { KeyboardUtils, KEYBOARD } from './KeyboardUtils';\nimport { IQuickViewHeaderOptions } from './DomUtils';\nimport { IQueryResult } from '../rest/QueryResult';\nimport { IComponentBindings } from '../ui/Base/ComponentBindings';\nimport { DomUtils } from '../Core';\n\nexport interface IAccessibleModalOptions {\n  overlayClose?: boolean;\n  sizeMod: 'small' | 'normal' | 'big';\n}\n\nexport interface IAccessibleModalOpenParameters {\n  content: HTMLElement;\n  validation: () => boolean;\n  origin: HTMLElement;\n}\n\nexport interface IAccessibleModalOpenResultParameters extends IAccessibleModalOpenParameters {\n  result: IQueryResult;\n  options: IQuickViewHeaderOptions;\n  bindings: IComponentBindings;\n}\n\nexport interface IAccessibleModalOpenNormalParameters extends IAccessibleModalOpenParameters {\n  title: HTMLElement;\n}\n\nexport class AccessibleModal {\n  private focusTrap: FocusTrap;\n  private activeModal: Coveo.ModalBox.ModalBox;\n  private options: IAccessibleModalOptions;\n  private initiallyFocusedElement: HTMLElement;\n\n  public get isOpen() {\n    return !!this.focusTrap;\n  }\n\n  public get element() {\n    return this.activeModal && this.activeModal.modalBox;\n  }\n\n  public get content() {\n    return this.activeModal && this.activeModal.content;\n  }\n\n  public get wrapper() {\n    return this.activeModal && this.activeModal.wrapper;\n  }\n\n  private get headerElement() {\n    return this.element && this.element.querySelector<HTMLElement>('.coveo-modal-header h1');\n  }\n\n  constructor(\n    private className: string,\n    private ownerElement: HTMLElement,\n    private modalboxModule: Coveo.ModalBox.ModalBox = ModalBoxModule,\n    options: Partial<IAccessibleModalOptions> = {}\n  ) {\n    this.options = {\n      ...{\n        sizeMod: 'big'\n      },\n      ...options\n    };\n  }\n\n  public openResult(parameters: IAccessibleModalOpenResultParameters) {\n    if (this.isOpen) {\n      return;\n    }\n    this.openModalAndTrap({\n      content: parameters.content,\n      validation: parameters.validation,\n      origin: parameters.origin,\n      title: DomUtils.getQuickviewHeader(parameters.result, parameters.options, parameters.bindings).el\n    });\n    this.makeAccessible(parameters.options.title || parameters.result.title);\n  }\n\n  public open(parameters: IAccessibleModalOpenNormalParameters) {\n    if (this.isOpen) {\n      return;\n    }\n    this.openModalAndTrap(parameters);\n    this.makeAccessible();\n  }\n\n  private openModalAndTrap(parameters: IAccessibleModalOpenNormalParameters) {\n    this.initiallyFocusedElement = parameters.origin || (document.activeElement as HTMLElement);\n    this.activeModal = this.modalboxModule.open(parameters.content, {\n      title: parameters.title,\n      className: this.className,\n      validation: () => {\n        this.onModalClose();\n        return parameters.validation();\n      },\n      body: this.ownerElement,\n      sizeMod: this.options.sizeMod,\n      overlayClose: this.options.overlayClose\n    });\n    this.focusTrap = new FocusTrap(this.element);\n  }\n\n  public close() {\n    if (!this.isOpen) {\n      return;\n    }\n    this.activeModal.close();\n    this.activeModal = null;\n  }\n\n  private makeAccessible(title?: string) {\n    this.element.setAttribute('aria-modal', 'true');\n    if (title) {\n      this.headerElement.setAttribute('aria-label', title);\n    }\n    this.makeCloseButtonAccessible();\n  }\n\n  private makeCloseButtonAccessible() {\n    const closeButton: HTMLElement = this.element.querySelector('.coveo-small-close');\n    closeButton.setAttribute('aria-label', l('Close'));\n    closeButton.setAttribute('role', 'button');\n    closeButton.tabIndex = 0;\n    closeButton.focus();\n    $$(closeButton).on('keyup', KeyboardUtils.keypressAction(KEYBOARD.ENTER, () => closeButton.click()));\n  }\n\n  private onModalClose() {\n    this.focusTrap.disable();\n    this.focusTrap = null;\n    if (this.initiallyFocusedElement && document.body.contains(this.initiallyFocusedElement)) {\n      this.initiallyFocusedElement.focus();\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/AccessibleModal.ts","import { ModalBox as ModalBoxModule } from '../../ExternalModulesShim';\nimport { exportGlobally } from '../../GlobalExports';\nimport { Component } from '../Base/Component';\nimport { IComponentBindings } from '../Base/ComponentBindings';\nimport { QueryEvents, Initialization, $$ } from '../../Core';\nimport { IQuerySuccessEventArgs } from '../../events/QueryEvents';\nimport { IQuestionAnswerResponse } from '../../rest/QuestionAnswerResponse';\nimport 'styling/_SmartSnippet';\nimport { find } from 'underscore';\nimport { IQueryResult } from '../../rest/QueryResult';\nimport { UserFeedbackBanner } from './UserFeedbackBanner';\nimport {\n  analyticsActionCauseList,\n  IAnalyticsNoMeta,\n  IAnalyticsSmartSnippetFeedbackMeta,\n  AnalyticsSmartSnippetFeedbackReason\n} from '../Analytics/AnalyticsActionListMeta';\nimport { HeightLimiter } from './HeightLimiter';\nimport { ExplanationModal, IReason } from './ExplanationModal';\nimport { l } from '../../strings/Strings';\nimport { attachShadow } from '../../misc/AttachShadowPolyfill';\nimport { Utils } from '../../utils/Utils';\n\ninterface ISmartSnippetReason {\n  analytics: AnalyticsSmartSnippetFeedbackReason;\n  localeKey: string;\n  hasDetails?: boolean;\n}\n\nconst reasons: ISmartSnippetReason[] = [\n  {\n    analytics: AnalyticsSmartSnippetFeedbackReason.DoesNotAnswer,\n    localeKey: 'UsefulnessFeedbackDoesNotAnswer'\n  },\n  {\n    analytics: AnalyticsSmartSnippetFeedbackReason.PartiallyAnswers,\n    localeKey: 'UsefulnessFeedbackPartiallyAnswers'\n  },\n  {\n    analytics: AnalyticsSmartSnippetFeedbackReason.WasNotAQuestion,\n    localeKey: 'UsefulnessFeedbackWasNotAQuestion'\n  },\n  {\n    analytics: AnalyticsSmartSnippetFeedbackReason.Other,\n    localeKey: 'Other',\n    hasDetails: true\n  }\n];\n\nconst BASE_CLASSNAME = 'coveo-smart-snippet';\nconst QUESTION_CLASSNAME = `${BASE_CLASSNAME}-question`;\nconst ANSWER_CONTAINER_CLASSNAME = `${BASE_CLASSNAME}-answer`;\nconst HAS_ANSWER_CLASSNAME = `${BASE_CLASSNAME}-has-answer`;\nconst SHADOW_CLASSNAME = `${BASE_CLASSNAME}-content`;\nconst CONTENT_CLASSNAME = `${BASE_CLASSNAME}-content-wrapper`;\nconst SOURCE_CLASSNAME = `${BASE_CLASSNAME}-source`;\nconst SOURCE_TITLE_CLASSNAME = `${SOURCE_CLASSNAME}-title`;\nconst SOURCE_URL_CLASSNAME = `${SOURCE_CLASSNAME}-url`;\n\nexport const SmartSnippetClassNames = {\n  QUESTION_CLASSNAME,\n  ANSWER_CONTAINER_CLASSNAME,\n  HAS_ANSWER_CLASSNAME,\n  SHADOW_CLASSNAME,\n  CONTENT_CLASSNAME,\n  SOURCE_CLASSNAME,\n  SOURCE_TITLE_CLASSNAME,\n  SOURCE_URL_CLASSNAME\n};\n\nexport class SmartSnippet extends Component {\n  static ID = 'SmartSnippet';\n\n  static doExport = () => {\n    exportGlobally({\n      SmartSnippet\n    });\n  };\n\n  private lastRenderedResult: IQueryResult;\n  private questionContainer: HTMLElement;\n  private shadowContainer: HTMLElement;\n  private sourceContainer: HTMLElement;\n  private snippetContainer: HTMLElement;\n  private heightLimiter: HeightLimiter;\n  private explanationModal: ExplanationModal;\n  private feedbackBanner: UserFeedbackBanner;\n  private shadowLoading: Promise<HTMLElement>;\n\n  constructor(public element: HTMLElement, public options?: {}, bindings?: IComponentBindings, private ModalBox = ModalBoxModule) {\n    super(element, SmartSnippet.ID, bindings);\n    this.bind.onRootElement(QueryEvents.deferredQuerySuccess, (data: IQuerySuccessEventArgs) => this.handleQuerySuccess(data));\n  }\n\n  private get style() {\n    return $$(this.element)\n      .children()\n      .filter(element => element instanceof HTMLScriptElement && element.type.toLowerCase() === 'text/css')\n      .map(element => element.innerHTML)\n      .join('\\n');\n  }\n\n  private set hasAnswer(hasAnswer: boolean) {\n    $$(this.element).toggleClass(HAS_ANSWER_CLASSNAME, hasAnswer);\n  }\n\n  public createDom() {\n    this.element.appendChild(this.buildAnswerContainer());\n    this.feedbackBanner = new UserFeedbackBanner(\n      isUseful => (isUseful ? this.sendLikeSmartSnippetAnalytics() : this.sendDislikeSmartSnippetAnalytics()),\n      () => this.openExplanationModal()\n    );\n    this.element.appendChild(this.feedbackBanner.build());\n    this.explanationModal = new ExplanationModal({\n      reasons: reasons.map(\n        reason =>\n          <IReason>{\n            label: l(reason.localeKey),\n            id: reason.analytics.replace(/_/g, '-'),\n            onSelect: () => this.sendExplanationAnalytics(reason.analytics, this.explanationModal.details),\n            hasDetails: reason.hasDetails\n          }\n      ),\n      onClosed: () => this.sendCloseFeedbackModalAnalytics(),\n      ownerElement: this.searchInterface.options.modalContainer,\n      modalBoxModule: this.ModalBox\n    });\n  }\n\n  private buildAnswerContainer() {\n    return $$(\n      'div',\n      {\n        className: ANSWER_CONTAINER_CLASSNAME\n      },\n      this.buildQuestion(),\n      this.buildShadow(),\n      this.buildHeightLimiter(),\n      this.buildSourceContainer()\n    ).el;\n  }\n\n  private buildQuestion() {\n    return (this.questionContainer = $$('div', { className: QUESTION_CLASSNAME }).el);\n  }\n\n  private buildShadow() {\n    this.shadowContainer = $$('div', { className: SHADOW_CLASSNAME }).el;\n    this.snippetContainer = $$('section', { className: CONTENT_CLASSNAME }).el;\n    this.shadowLoading = attachShadow(this.shadowContainer, { mode: 'open', title: l('AnswerSnippet') }).then(shadow => {\n      shadow.appendChild(this.snippetContainer);\n      const style = this.buildStyle();\n      if (style) {\n        shadow.appendChild(style);\n      }\n      return shadow;\n    });\n    return this.shadowContainer;\n  }\n\n  private buildHeightLimiter() {\n    return (this.heightLimiter = new HeightLimiter(this.shadowContainer, this.snippetContainer, 400, isExpanded =>\n      isExpanded ? this.sendExpandSmartSnippetAnalytics() : this.sendCollapseSmartSnippetAnalytics()\n    )).toggleButton;\n  }\n\n  private buildSourceContainer() {\n    return (this.sourceContainer = $$('div', { className: SOURCE_CLASSNAME }).el);\n  }\n\n  private buildStyle() {\n    const style = this.style;\n    if (!style) {\n      return;\n    }\n    const styleTag = document.createElement('style');\n    styleTag.innerHTML = style;\n    return styleTag;\n  }\n\n  /**\n   * @warning This method only works for the demo. In practice, the source of the answer will not always be part of the results.\n   */\n  private getCorrespondingResult(questionAnswer: IQuestionAnswerResponse) {\n    return find(\n      this.queryController.getLastResults().results,\n      result => result.raw[questionAnswer.documentId.contentIdKey] === questionAnswer.documentId.contentIdValue\n    );\n  }\n\n  private async handleQuerySuccess(data: IQuerySuccessEventArgs) {\n    const { questionAnswer } = data.results;\n    if (!questionAnswer) {\n      this.hasAnswer = false;\n      return;\n    }\n    this.hasAnswer = true;\n    await this.render(questionAnswer);\n  }\n\n  private async render(questionAnswer: IQuestionAnswerResponse) {\n    this.ensureDom();\n    this.questionContainer.innerText = questionAnswer.question;\n    this.renderSnippet(questionAnswer.answerSnippet);\n    const lastRenderedResult = this.getCorrespondingResult(questionAnswer);\n    if (lastRenderedResult) {\n      this.renderSource(lastRenderedResult);\n    }\n    await this.shadowLoading;\n    await Utils.resolveAfter(0); // `scrollHeight` isn't instantly detected, or at-least not on IE11.\n    this.heightLimiter.onContentHeightChanged();\n  }\n\n  private renderSnippet(content: string) {\n    this.snippetContainer.innerHTML = content;\n  }\n\n  private renderSource(source: IQueryResult) {\n    $$(this.sourceContainer).empty();\n    this.sourceContainer.appendChild(this.renderSourceUrl(source.clickUri));\n    this.sourceContainer.appendChild(this.renderSourceTitle(source.title, source.clickUri));\n  }\n\n  private renderSourceTitle(title: string, clickUri: string) {\n    return this.renderLink(title, clickUri, SOURCE_TITLE_CLASSNAME);\n  }\n\n  private renderSourceUrl(url: string) {\n    return this.renderLink(url, url, SOURCE_URL_CLASSNAME);\n  }\n\n  private renderLink(text: string, href: string, className: string) {\n    const element = $$('a', { className, href }).el as HTMLAnchorElement;\n    element.innerText = text;\n    this.enableAnalyticsOnLink(element, () => this.sendOpenSourceAnalytics());\n    return element;\n  }\n\n  private enableAnalyticsOnLink(link: HTMLAnchorElement, sendAnalytics: () => Promise<any>) {\n    link.addEventListener('click', e => {\n      e.preventDefault();\n      this.openLink(link.href, e.ctrlKey, sendAnalytics);\n    });\n  }\n\n  private openLink(href: string, newTab: boolean, sendAnalytics: () => Promise<any>) {\n    sendAnalytics();\n    if (newTab) {\n      window.open(href);\n    } else {\n      window.location.href = href;\n    }\n  }\n\n  private openExplanationModal() {\n    this.sendOpenFeedbackModalAnalytics();\n    this.explanationModal.open(this.feedbackBanner.explainWhy);\n  }\n\n  private sendLikeSmartSnippetAnalytics() {\n    return this.usageAnalytics.logCustomEvent<IAnalyticsNoMeta>(\n      analyticsActionCauseList.likeSmartSnippet,\n      {},\n      this.element,\n      this.lastRenderedResult\n    );\n  }\n\n  private sendDislikeSmartSnippetAnalytics() {\n    return this.usageAnalytics.logCustomEvent<IAnalyticsNoMeta>(\n      analyticsActionCauseList.dislikeSmartSnippet,\n      {},\n      this.element,\n      this.lastRenderedResult\n    );\n  }\n\n  private sendExpandSmartSnippetAnalytics() {\n    return this.usageAnalytics.logCustomEvent<IAnalyticsNoMeta>(\n      analyticsActionCauseList.expandSmartSnippet,\n      {},\n      this.element,\n      this.lastRenderedResult\n    );\n  }\n\n  private sendCollapseSmartSnippetAnalytics() {\n    return this.usageAnalytics.logCustomEvent<IAnalyticsNoMeta>(\n      analyticsActionCauseList.collapseSmartSnippet,\n      {},\n      this.element,\n      this.lastRenderedResult\n    );\n  }\n\n  private sendOpenSourceAnalytics() {\n    return this.usageAnalytics.logCustomEvent<IAnalyticsNoMeta>(\n      analyticsActionCauseList.openSmartSnippetSource,\n      {},\n      this.element,\n      this.lastRenderedResult\n    );\n  }\n\n  private sendOpenFeedbackModalAnalytics() {\n    return this.usageAnalytics.logCustomEvent<IAnalyticsNoMeta>(\n      analyticsActionCauseList.openSmartSnippetFeedbackModal,\n      {},\n      this.element,\n      this.lastRenderedResult\n    );\n  }\n\n  private sendCloseFeedbackModalAnalytics() {\n    return this.usageAnalytics.logCustomEvent<IAnalyticsNoMeta>(\n      analyticsActionCauseList.closeSmartSnippetFeedbackModal,\n      {},\n      this.element,\n      this.lastRenderedResult\n    );\n  }\n\n  private sendExplanationAnalytics(reason: AnalyticsSmartSnippetFeedbackReason, details?: string) {\n    return this.usageAnalytics.logCustomEvent<IAnalyticsSmartSnippetFeedbackMeta>(\n      analyticsActionCauseList.sendSmartSnippetReason,\n      {\n        reason,\n        details\n      },\n      this.element,\n      this.lastRenderedResult\n    );\n  }\n}\nInitialization.registerAutoCreateComponent(SmartSnippet);\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/SmartSnippet/SmartSnippet.ts","import { Defer } from '../../misc/Defer';\nimport { sortBy, without } from 'underscore';\nimport { $$ } from '../../utils/Dom';\n\nexport class FocusTrap {\n  private focusInEvent: (e: FocusEvent) => void;\n  private focusOutEvent: (e: FocusEvent) => void;\n  private hiddenElements: HTMLElement[];\n  private enabled: boolean;\n\n  private get focusableElements(): HTMLElement[] {\n    return sortBy(this.container.querySelectorAll('[tabindex]'), element => element.tabIndex);\n  }\n\n  constructor(private container: HTMLElement) {\n    this.hiddenElements = [];\n    this.enable();\n  }\n\n  public disable() {\n    document.removeEventListener('focusin', this.focusInEvent);\n    document.removeEventListener('focusout', this.focusOutEvent);\n    this.showHiddenElements();\n    this.enabled = false;\n  }\n\n  private enable() {\n    document.addEventListener('focusin', (this.focusInEvent = e => this.onFocusIn(e)));\n    document.addEventListener('focusout', (this.focusOutEvent = e => this.onFocusOut(e)));\n    this.hideAllExcept(this.container);\n    this.enabled = true;\n  }\n\n  private showHiddenElements() {\n    while (this.hiddenElements.length) {\n      this.hiddenElements.pop().removeAttribute('aria-hidden');\n    }\n  }\n\n  private hideElement(element: HTMLElement) {\n    if (element.getAttribute('aria-hidden')) {\n      return;\n    }\n    this.hiddenElements.push(element);\n    element.setAttribute('aria-hidden', `${true}`);\n  }\n\n  private hideSiblings(allowedElement: HTMLElement) {\n    const parent = allowedElement.parentElement;\n    if (parent) {\n      without($$(parent).children(), allowedElement).forEach(elementToHide => {\n        this.hideElement(elementToHide);\n      });\n    }\n  }\n\n  private hideAllExcept(allowedElement: HTMLElement) {\n    this.hideSiblings(allowedElement);\n    const parent = allowedElement.parentElement;\n    if (parent && parent !== document.body) {\n      this.hideAllExcept(parent);\n    }\n  }\n\n  private getFocusableSibling(element: HTMLElement, previous = false) {\n    const elements = this.focusableElements;\n    const currentIndex = elements.indexOf(element);\n    if (currentIndex === -1) {\n      return null;\n    }\n    return elements[(currentIndex + (previous ? -1 : 1) + elements.length) % elements.length];\n  }\n\n  private focusSibling(element: HTMLElement, previous = false) {\n    const sibling = this.getFocusableSibling(element, previous);\n    if (sibling) {\n      sibling.focus();\n    }\n  }\n\n  private focusFirstElement() {\n    const elements = this.focusableElements;\n    if (elements.length) {\n      elements[0].focus();\n    }\n  }\n\n  private elementIsBefore(oldElement: HTMLElement, newElement: HTMLElement) {\n    if (!newElement) {\n      return false;\n    }\n    return oldElement.compareDocumentPosition(newElement) === Node.DOCUMENT_POSITION_PRECEDING;\n  }\n\n  private onLosingFocus(oldElement: HTMLElement, newElement: HTMLElement) {\n    Defer.defer(() => {\n      if (!this.enabled) {\n        return;\n      }\n      this.enabled = false;\n      if (oldElement && this.focusIsAllowed(oldElement)) {\n        this.focusSibling(oldElement, this.elementIsBefore(oldElement, newElement));\n      } else {\n        this.focusFirstElement();\n      }\n      this.enabled = true;\n    });\n  }\n\n  private focusIsAllowed(element: HTMLElement) {\n    return this.container.contains(element);\n  }\n\n  private elementIsInPage(element: HTMLElement) {\n    return element && element !== document.body.parentElement;\n  }\n\n  private onFocusIn(e: FocusEvent) {\n    if (!this.enabled) {\n      return;\n    }\n    const oldElement = e.relatedTarget as HTMLElement;\n    const handledByFocusOut = this.elementIsInPage(oldElement);\n    if (handledByFocusOut) {\n      return;\n    }\n    const newElement = e.target as HTMLElement;\n    if (!this.elementIsInPage(newElement)) {\n      return;\n    }\n    if (!this.focusIsAllowed(newElement)) {\n      this.onLosingFocus(null, newElement);\n    }\n  }\n\n  private onFocusOut(e: FocusEvent) {\n    if (!this.enabled) {\n      return;\n    }\n    const newElement = e.relatedTarget as HTMLElement;\n    if (!this.elementIsInPage(newElement)) {\n      return;\n    }\n    if (!newElement || !this.focusIsAllowed(newElement)) {\n      this.onLosingFocus(e.target as HTMLElement, newElement);\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/FocusTrap/FocusTrap.ts","import { $$ } from '../utils/Dom';\nimport 'styling/_AttachShadowPolyfill';\n\nexport async function attachShadow(element: HTMLElement, init: ShadowRootInit & { title: string }): Promise<HTMLElement> {\n  const iframe = $$('iframe', { className: 'coveo-shadow-iframe', scrolling: 'no', title: init.title }).el as HTMLIFrameElement;\n  const onLoad = new Promise(resolve => iframe.addEventListener('load', () => resolve()));\n  element.appendChild(iframe);\n  await onLoad;\n\n  const iframeBody = iframe.contentDocument.body as HTMLBodyElement;\n  iframeBody.style.margin = '0';\n  const shadowRoot = $$('div', { style: 'overflow: auto;' }).el;\n  iframeBody.appendChild(shadowRoot);\n  autoUpdateHeight(iframe, shadowRoot);\n  if (init.mode === 'open') {\n    Object.defineProperty(element, 'shadowRoot', { get: () => shadowRoot });\n  }\n\n  return shadowRoot;\n}\n\nfunction autoUpdateHeight(elementToResize: HTMLElement, content: HTMLElement) {\n  const heightObserver = new MutationObserver(() => {\n    elementToResize.style.height = `${content.clientHeight}px`;\n  });\n  heightObserver.observe(content, {\n    attributes: true,\n    characterData: true,\n    childList: true,\n    subtree: true\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/misc/AttachShadowPolyfill.ts","import { $$ } from '../../utils/Dom';\nimport { l } from '../../strings/Strings';\nimport { SVGIcons } from '../../utils/SVGIcons';\nimport { uniqueId } from 'underscore';\n\nconst ROOT_CLASSNAME = 'coveo-user-feedback-banner';\nconst CONTAINER_CLASSNAME = `${ROOT_CLASSNAME}-container`;\nconst LABEL_CLASSNAME = `${ROOT_CLASSNAME}-label`;\nconst BUTTONS_CONTAINER_CLASSNAME = `${ROOT_CLASSNAME}-buttons`;\nconst YES_BUTTON_CLASSNAME = `${ROOT_CLASSNAME}-yes-button`;\nconst NO_BUTTON_CLASSNAME = `${ROOT_CLASSNAME}-no-button`;\nconst BUTTON_ACTIVE_CLASSNAME = `${ROOT_CLASSNAME}-button-active`;\nconst THANK_YOU_BANNER_CLASSNAME = `${ROOT_CLASSNAME}-thanks`;\nconst THANK_YOU_BANNER_ACTIVE_CLASSNAME = `${THANK_YOU_BANNER_CLASSNAME}-active`;\nconst ICON_CLASSNAME = `${THANK_YOU_BANNER_CLASSNAME}-icon`;\nconst EXPLAIN_WHY_CLASSNAME = `${ROOT_CLASSNAME}-explain-why`;\nconst EXPLAIN_WHY_ACTIVE_CLASSNAME = `${EXPLAIN_WHY_CLASSNAME}-active`;\n\nenum UsefulState {\n  Unknown,\n  Yes,\n  No\n}\n\ninterface IButtonOptions {\n  text: string;\n  className: string;\n  action: Function;\n  icon?: {\n    content: string;\n    className: string;\n  };\n  attributes?: any;\n}\n\nexport const UserFeedbackBannerClassNames = {\n  ROOT_CLASSNAME,\n  CONTAINER_CLASSNAME,\n  LABEL_CLASSNAME,\n  BUTTONS_CONTAINER_CLASSNAME,\n  YES_BUTTON_CLASSNAME,\n  NO_BUTTON_CLASSNAME,\n  BUTTON_ACTIVE_CLASSNAME,\n  THANK_YOU_BANNER_CLASSNAME,\n  THANK_YOU_BANNER_ACTIVE_CLASSNAME,\n  ICON_CLASSNAME,\n  EXPLAIN_WHY_CLASSNAME,\n  EXPLAIN_WHY_ACTIVE_CLASSNAME\n};\n\nexport class UserFeedbackBanner {\n  public explainWhy: HTMLElement;\n  private isUseful = UsefulState.Unknown;\n  private yesButton: HTMLElement;\n  private noButton: HTMLElement;\n  private thankYouBanner: HTMLElement;\n  private labelId: string;\n\n  constructor(private readonly sendUsefulnessAnalytics: (isUseful: boolean) => void, private readonly onExplainWhyPressed: () => void) {\n    this.labelId = uniqueId(LABEL_CLASSNAME);\n  }\n\n  public build() {\n    return $$(\n      'div',\n      {\n        className: ROOT_CLASSNAME,\n        ariaLive: 'polite'\n      },\n      this.buildContainer(),\n      this.buildThankYouBanner()\n    ).el;\n  }\n\n  private buildContainer() {\n    return $$(\n      'div',\n      {\n        className: CONTAINER_CLASSNAME,\n        ariaLabelledby: this.labelId\n      },\n      this.buildLabel(),\n      this.buildButtons()\n    ).el;\n  }\n\n  private buildLabel() {\n    return $$('span', { className: LABEL_CLASSNAME, id: this.labelId }, l('UsefulnessFeedbackRequest')).el;\n  }\n\n  private buildThankYouBanner() {\n    this.thankYouBanner = $$('div', { className: THANK_YOU_BANNER_CLASSNAME }).el;\n\n    const text = $$('span', {}, l('UsefulnessFeedbackThankYou')).el;\n    this.thankYouBanner.appendChild(text);\n\n    this.explainWhy = this.buildButton({\n      text: l('UsefulnessFeedbackExplainWhy'),\n      className: EXPLAIN_WHY_CLASSNAME,\n      action: () => this.requestExplaination()\n    });\n    this.thankYouBanner.appendChild(this.explainWhy);\n\n    return this.thankYouBanner;\n  }\n\n  private buildButtons() {\n    const buttonsContainer = $$('div', { className: BUTTONS_CONTAINER_CLASSNAME }).el;\n\n    this.yesButton = this.buildButton({\n      text: l('Yes'),\n      className: YES_BUTTON_CLASSNAME,\n      action: () => this.showThankYouBanner(true),\n      icon: {\n        className: ICON_CLASSNAME,\n        content: SVGIcons.icons.checkYes\n      },\n      attributes: {\n        ariaPressed: false,\n        ariaDescribedby: this.labelId\n      }\n    });\n    this.yesButton.setAttribute('aria-pressed', 'false');\n    buttonsContainer.appendChild(this.yesButton);\n\n    this.noButton = this.buildButton({\n      text: l('No'),\n      className: NO_BUTTON_CLASSNAME,\n      action: () => this.showThankYouBanner(false),\n      icon: {\n        className: ICON_CLASSNAME,\n        content: SVGIcons.icons.clearSmall\n      },\n      attributes: {\n        ariaPressed: false,\n        ariaDescribedby: this.labelId\n      }\n    });\n    buttonsContainer.appendChild(this.noButton);\n\n    return buttonsContainer;\n  }\n\n  private buildButton(options: IButtonOptions) {\n    const button = $$('button', { ...(options.attributes || {}), className: options.className }).el;\n\n    if (options.icon) {\n      const icon = $$('span', { className: options.icon.className }, options.icon.content).el;\n      button.appendChild(icon);\n      const text = $$('span', {}, options.text).el;\n      button.appendChild(text);\n    } else {\n      button.innerText = options.text;\n    }\n\n    button.addEventListener('click', () => options.action());\n\n    return button;\n  }\n\n  private showThankYouBanner(isUseful: boolean) {\n    if (this.isUseful !== UsefulState.Unknown && isUseful === (this.isUseful === UsefulState.Yes)) {\n      return;\n    }\n    this.isUseful = isUseful ? UsefulState.Yes : UsefulState.No;\n    $$(this.yesButton).toggleClass(BUTTON_ACTIVE_CLASSNAME, isUseful);\n    $$(this.yesButton).setAttribute('aria-pressed', `${isUseful}`);\n    $$(this.noButton).toggleClass(BUTTON_ACTIVE_CLASSNAME, !isUseful);\n    $$(this.noButton).setAttribute('aria-pressed', `${!isUseful}`);\n    $$(this.thankYouBanner).addClass(THANK_YOU_BANNER_ACTIVE_CLASSNAME);\n    $$(this.explainWhy).toggleClass(EXPLAIN_WHY_ACTIVE_CLASSNAME, !isUseful);\n    this.sendUsefulnessAnalytics(isUseful);\n  }\n\n  private requestExplaination() {\n    this.onExplainWhyPressed();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/SmartSnippet/UserFeedbackBanner.ts","import { $$ } from '../../utils/Dom';\nimport { SVGIcons } from '../../utils/SVGIcons';\nimport { l } from '../../strings/Strings';\n\nconst BASE_CLASSNAME = 'coveo-height-limiter';\nconst CONTAINER_ACTIVE_CLASSNAME = `${BASE_CLASSNAME}-container-active`;\nconst CONTAINER_EXPANDED_CLASSNAME = `${BASE_CLASSNAME}-container-expanded`;\nconst BUTTON_CLASSNAME = `${BASE_CLASSNAME}-button`;\nconst BUTTON_LABEL_CLASSNAME = `${BUTTON_CLASSNAME}-label`;\nconst BUTTON_ICON_CLASSNAME = `${BUTTON_CLASSNAME}-icon`;\nconst BUTTON_ACTIVE_CLASSNAME = `${BUTTON_CLASSNAME}-active`;\n\nexport const HeightLimiterClassNames = {\n  CONTAINER_ACTIVE_CLASSNAME,\n  CONTAINER_EXPANDED_CLASSNAME,\n  BUTTON_CLASSNAME,\n  BUTTON_LABEL_CLASSNAME,\n  BUTTON_ICON_CLASSNAME,\n  BUTTON_ACTIVE_CLASSNAME\n};\n\nexport class HeightLimiter {\n  private isExpanded = false;\n  private button: HTMLElement;\n  private buttonLabel: HTMLElement;\n  private buttonIcon: HTMLElement;\n\n  public get toggleButton() {\n    return this.button;\n  }\n\n  private set height(height: number) {\n    this.containerElement.style.height = `${height}px`;\n  }\n\n  private get contentHeight() {\n    return this.contentElement.clientHeight;\n  }\n\n  constructor(\n    private containerElement: HTMLElement,\n    private contentElement: HTMLElement,\n    private heightLimit: number,\n    private onToggle?: (isExpanded: boolean) => void\n  ) {\n    this.buildButton();\n    this.updateActiveAppearance();\n  }\n\n  public onContentHeightChanged() {\n    this.updateActiveAppearance();\n  }\n\n  private buildButton() {\n    this.button = $$(\n      'button',\n      { className: BUTTON_CLASSNAME, ariaLabel: l('ShowMore'), ariaPressed: 'false', ariaHidden: 'true' },\n      (this.buttonLabel = $$('span', { className: BUTTON_LABEL_CLASSNAME }).el),\n      (this.buttonIcon = $$('span', { className: BUTTON_ICON_CLASSNAME }).el)\n    ).el;\n    this.button.addEventListener('click', () => this.toggle());\n    this.updateButton();\n    return this.button;\n  }\n\n  private updateActiveAppearance() {\n    const shouldBeActive = this.contentHeight > this.heightLimit;\n    $$(this.containerElement).toggleClass(CONTAINER_ACTIVE_CLASSNAME, shouldBeActive);\n    $$(this.button).toggleClass(BUTTON_ACTIVE_CLASSNAME, shouldBeActive);\n    if (shouldBeActive) {\n      this.updateExpandedAppearance();\n    } else {\n      this.isExpanded = false;\n      this.updateExpandedAppearance();\n      this.containerElement.style.height = '';\n    }\n  }\n\n  private updateButton() {\n    this.buttonLabel.innerText = this.isExpanded ? l('ShowLess') : l('ShowMore');\n    this.button.setAttribute('aria-pressed', `${this.isExpanded}`);\n    this.buttonIcon.innerHTML = this.isExpanded ? SVGIcons.icons.arrowUp : SVGIcons.icons.arrowDown;\n  }\n\n  private updateExpandedAppearance() {\n    this.updateButton();\n    $$(this.containerElement).toggleClass(CONTAINER_EXPANDED_CLASSNAME, this.isExpanded);\n    this.height = this.isExpanded ? this.contentHeight : this.heightLimit;\n  }\n\n  private toggle() {\n    this.isExpanded = !this.isExpanded;\n    this.updateExpandedAppearance();\n    if (this.onToggle) {\n      this.onToggle(this.isExpanded);\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/SmartSnippet/HeightLimiter.ts","import { AccessibleModal } from '../../utils/AccessibleModal';\nimport { l } from '../../strings/Strings';\nimport { $$ } from '../../utils/Dom';\nimport { RadioButton } from '../FormWidgets/RadioButton';\nimport 'styling/_ExplanationModal';\n\nexport interface IReason {\n  label: string;\n  id: string;\n  onSelect: () => void;\n  hasDetails?: boolean;\n}\n\nexport interface IExplanationModalOptions {\n  ownerElement: HTMLElement;\n  reasons: IReason[];\n  onClosed: () => void;\n  modalBoxModule?: Coveo.ModalBox.ModalBox;\n}\n\nconst ROOT_CLASSNAME = 'coveo-user-explanation-modal';\nconst CONTENT_CLASSNAME = `${ROOT_CLASSNAME}-content`;\nconst EXPLANATION_SECTION_CLASSNAME = `${ROOT_CLASSNAME}-explanation-section`;\nconst REASONS_CLASSNAME = `${ROOT_CLASSNAME}-explanations`;\nconst REASONS_LABEL_CLASSNAME = `${REASONS_CLASSNAME}-label`;\nconst DETAILS_SECTION_CLASSNAME = `${ROOT_CLASSNAME}-details`;\nconst DETAILS_TEXTAREA_CLASSNAME = `${DETAILS_SECTION_CLASSNAME}-textarea`;\nconst DETAILS_LABEL_CLASSNAME = `${DETAILS_SECTION_CLASSNAME}-label`;\nconst BUTTONS_SECTION_CLASSNAME = `${ROOT_CLASSNAME}-buttons-section`;\nconst SEND_BUTTON_CLASSNAME = `${ROOT_CLASSNAME}-send-button`;\nconst CANCEL_BUTTON_CLASSNAME = `${ROOT_CLASSNAME}-cancel-button`;\nconst DETAILS_ID = DETAILS_SECTION_CLASSNAME;\n\nexport const ExplanationModalClassNames = {\n  ROOT_CLASSNAME,\n  CONTENT_CLASSNAME,\n  EXPLANATION_SECTION_CLASSNAME,\n  REASONS_CLASSNAME,\n  REASONS_LABEL_CLASSNAME,\n  DETAILS_SECTION_CLASSNAME,\n  DETAILS_TEXTAREA_CLASSNAME,\n  DETAILS_LABEL_CLASSNAME,\n  BUTTONS_SECTION_CLASSNAME,\n  SEND_BUTTON_CLASSNAME,\n  CANCEL_BUTTON_CLASSNAME\n};\n\nexport class ExplanationModal {\n  private modal: AccessibleModal;\n  private reasons: RadioButton[];\n  private selectedReason: IReason;\n  private detailsTextArea: HTMLTextAreaElement;\n  private shouldCallCloseEvent = false;\n\n  constructor(public options: IExplanationModalOptions) {\n    this.modal = new AccessibleModal(ROOT_CLASSNAME, this.options.ownerElement, this.options.modalBoxModule);\n  }\n\n  public get details() {\n    if (!this.selectedReason || !this.selectedReason.hasDetails) {\n      return null;\n    }\n    return this.detailsTextArea.value;\n  }\n\n  public open(origin: HTMLElement) {\n    this.modal.open({\n      origin,\n      title: l('UsefulnessFeedbackExplainWhyImperative'),\n      content: this.buildContent(),\n      validation: () => {\n        if (this.shouldCallCloseEvent) {\n          this.options.onClosed();\n          this.shouldCallCloseEvent = false;\n        }\n        return true;\n      }\n    });\n    this.shouldCallCloseEvent = true;\n  }\n\n  private buildContent() {\n    return $$(\n      'div',\n      {\n        className: CONTENT_CLASSNAME\n      },\n      this.buildExplanationSection(),\n      this.buildButtonsSection()\n    ).el;\n  }\n\n  private buildExplanationSection() {\n    const detailsSection = this.buildDetailsSection();\n    return $$(\n      'div',\n      {\n        className: EXPLANATION_SECTION_CLASSNAME\n      },\n      this.buildReasons(),\n      detailsSection\n    ).el;\n  }\n\n  private buildButtonsSection() {\n    return $$(\n      'div',\n      {\n        className: BUTTONS_SECTION_CLASSNAME\n      },\n      this.buildSendButton(),\n      this.buildCancelButton()\n    );\n  }\n\n  private buildReasons() {\n    const reasonsContainer = $$('fieldset', { className: REASONS_CLASSNAME }, this.buildReasonsLabel()).el;\n    this.reasons = this.options.reasons.map(reason => this.buildReasonRadioButton(reason));\n    this.reasons[0].select();\n    this.reasons.forEach(radioButton => reasonsContainer.appendChild(radioButton.getElement()));\n    return reasonsContainer;\n  }\n\n  private buildReasonsLabel() {\n    return $$('legend', { className: REASONS_LABEL_CLASSNAME }, l('UsefulnessFeedbackReason')).el;\n  }\n\n  private buildDetailsSection() {\n    return $$(\n      'div',\n      { className: DETAILS_SECTION_CLASSNAME },\n      $$('label', { className: DETAILS_LABEL_CLASSNAME, for: DETAILS_ID }, l('Details')).el,\n      (this.detailsTextArea = $$('textarea', { className: DETAILS_TEXTAREA_CLASSNAME, id: DETAILS_ID, disabled: true })\n        .el as HTMLTextAreaElement)\n    );\n  }\n\n  private buildSendButton() {\n    const button = $$('button', { className: SEND_BUTTON_CLASSNAME }, l('Send'));\n    button.on('click', () => {\n      this.selectedReason.onSelect();\n      this.shouldCallCloseEvent = false;\n      this.modal.close();\n    });\n    return button.el;\n  }\n\n  private buildCancelButton() {\n    const button = $$('button', { className: CANCEL_BUTTON_CLASSNAME }, l('Cancel'));\n    button.on('click', () => this.modal.close());\n    return button.el;\n  }\n\n  private buildReasonRadioButton(reason: IReason) {\n    return new RadioButton(\n      radioButton => {\n        if (!radioButton.isSelected()) {\n          return;\n        }\n        this.detailsTextArea.disabled = !reason.hasDetails;\n        this.selectedReason = reason;\n      },\n      reason.label,\n      'reason',\n      `coveo-reason-${reason.id}`\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/SmartSnippet/ExplanationModal.ts","import { $$ } from '../../utils/Dom';\nimport { IFormWidgetWithLabel, IFormWidgetSelectable } from './FormWidgets';\nimport 'styling/vapor/_Radio';\nimport { exportGlobally } from '../../GlobalExports';\n\n/**\n * A radio button widget with standard styling.\n */\nexport class RadioButton implements IFormWidgetWithLabel, IFormWidgetSelectable {\n  protected element: HTMLElement;\n\n  static doExport() {\n    exportGlobally({\n      RadioButton: RadioButton\n    });\n  }\n\n  /**\n   * Creates a new `RadioButton`.\n   * @param onChange The function to call when the radio button value changes. This function takes the current\n   * `RadioButton` instance as an argument.\n   * @param label The label to display next to the radio button.\n   * @param name The value to set the `input` HTMLElement `name` attribute to.\n   */\n  constructor(\n    public onChange: (radioButton: RadioButton) => void = (radioButton: RadioButton) => {},\n    public label: string,\n    public name: string,\n    private id: string = label\n  ) {\n    this.buildContent();\n  }\n\n  /**\n   * Resets the radio button.\n   */\n  public reset() {\n    const currentlySelected = this.isSelected();\n    this.getRadio().checked = false;\n    if (currentlySelected) {\n      this.onChange(this);\n    }\n  }\n\n  /**\n   * Select the radio button\n   * @param triggerChange will trigger change event if specified and the radio button is not already selected\n   */\n  public select(triggerChange = true) {\n    const currentlySelected = this.isSelected();\n    this.getRadio().checked = true;\n    if (!currentlySelected && triggerChange) {\n      this.onChange(this);\n    }\n  }\n\n  /**\n   * Gets the element on which the radio button is bound.\n   * @returns {HTMLElement} The radio button element.\n   */\n  public build(): HTMLElement {\n    return this.element;\n  }\n\n  /**\n   * Gets the element on which the radio button is bound.\n   * @returns {HTMLElement} The radio button element.\n   */\n  public getElement(): HTMLElement {\n    return this.element;\n  }\n\n  public getValue(): string {\n    return this.label;\n  }\n\n  /**\n   * Indicates whether the radio button is selected.\n   * @returns {boolean} `true` if the radio button is selected, `false` otherwise.\n   */\n  public isSelected(): boolean {\n    return this.getRadio().checked;\n  }\n\n  /**\n   * Gets the `input` element (the radio button itself).\n   * @returns {HTMLInputElement} The `input` element.\n   */\n  public getRadio(): HTMLInputElement {\n    return <HTMLInputElement>$$(this.element).find('input');\n  }\n\n  /**\n   * Gets the radio button [`label`]{@link RadioButton.label} element.\n   * @returns {HTMLLabelElement} The `label` element.\n   */\n  public getLabel(): HTMLLabelElement {\n    return <HTMLLabelElement>$$(this.element).find('label');\n  }\n\n  private buildContent() {\n    const radioOption = $$('div', { className: 'coveo-radio' });\n    const radioInput = $$('input', { type: 'radio', name: this.name, id: this.id });\n    const labelInput = $$('label', { className: 'coveo-radio-input-label', for: this.id });\n    labelInput.text(this.label);\n    radioInput.on('change', () => {\n      this.onChange(this);\n    });\n\n    radioOption.append(radioInput.el);\n    radioOption.append(labelInput.el);\n    this.element = radioOption.el;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/FormWidgets/RadioButton.ts"],"sourceRoot":""}